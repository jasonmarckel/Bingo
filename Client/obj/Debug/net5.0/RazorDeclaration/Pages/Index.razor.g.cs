// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Bingo.Client.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using Bingo.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\jason\Source\Bingo\Client\_Imports.razor"
using Bingo.Client.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\jason\Source\Bingo\Client\Pages\Index.razor"
using Microsoft.AspNetCore.SignalR.Client;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/")]
    public partial class Index : Microsoft.AspNetCore.Components.ComponentBase, IAsyncDisposable
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 85 "C:\Users\jason\Source\Bingo\Client\Pages\Index.razor"
       
    private Card card;
    private string playerName = "Jason";
    private HubConnection hubConnection;
    private List<string> messages = new List<string>();
    private string messageInput;

    public class Card
    {
        public string StampClass { get; set; }
        public Square[,] Squares { get; set; } = new Square[5,5];

        public Card()
        {
            StampClass = "DefaultStamp";    
            GenerateNewCard();
        }

        public void GenerateNewCard()
        {
            var rnd = new Random();
            var uniqueValues = new HashSet<int>();

            // generate a set of 5 unique integers for each column
            for (int c = 0; c < 5; c++)
            {
                // determine the low and high numbers for the column
                int minValue = 1 + (c * 15);
                int maxValue = 15 + (c * 15);
                // initialize the HashSet for the column to hold the uniqe values
                uniqueValues.Clear();
                // generate random numbers until we have 5 unique numbers for the column
                while (uniqueValues.Count < 5)
                {
                    // generate a random number
                    int x  = rnd.Next(minValue, maxValue);
                    // the number will only be added to the HashSet if it
                    // does not already exist in the HashSet
                    uniqueValues.Add(x);
                }
                // copy the unique values for the column to the card
                for (int r = 0; r < 5; r++)
                {
                    Squares[r,c] = new Square() { Value = uniqueValues.ElementAt(r).ToString() };
                    if (c == 2 && r == 2)
                    {
                        Squares[r,c].Value = "FREE";
                        Squares[r,c].StampClass = StampClass;
                    }
                }
            }
        }

        public class Square
        {
            public string Value { get; set; }
            public bool IsStamped { get { return !string.IsNullOrWhiteSpace(StampClass); } }
            public string StampClass { get; set; }
        }

    }

    protected override async Task OnInitializedAsync()
    {
        card = new Card();

        hubConnection = new HubConnectionBuilder()
            .WithUrl(NavigationManager.ToAbsoluteUri("/callerhub"))
            .Build();

        hubConnection.On<string, string>("ReceiveMessage", (user, message) =>
        {
            var encodedMsg = $"{user}: {message}";
            messages.Add(encodedMsg);
            StateHasChanged();
        });

        await hubConnection.StartAsync();

    }

    Task Send() =>
        hubConnection.SendAsync("SendMessage", playerName, messageInput);

    public bool IsConnected =>
        hubConnection.State == HubConnectionState.Connected;
        
    public async ValueTask DisposeAsync()
    {
        await hubConnection.DisposeAsync();
    }

    private void StampSquare(MouseEventArgs e, int row, int col, string stampClass)
    {
        if (row == 2 && col == 2) { return; }
        var square = card.Squares[row, col];
        square.StampClass = square.IsStamped ? string.Empty : card.StampClass;
    }
    private void GenerateNewCard()
    {
        card.GenerateNewCard();
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavigationManager { get; set; }
    }
}
#pragma warning restore 1591
